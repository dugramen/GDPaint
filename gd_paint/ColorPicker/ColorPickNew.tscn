[gd_scene load_steps=22 format=2]

[ext_resource path="res://icon.png" type="Texture" id=1]
[ext_resource path="res://addons/gd_paint/ColorPicker/selector.png" type="Texture" id=2]
[ext_resource path="res://addons/gd_paint/ColorPicker/ColorPickPlus.gd" type="Script" id=3]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;

uniform vec4 hue_color: hint_color = vec4(1.0);

vec4 hsv2rgb(vec4 c) {
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return vec4(c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y), c.a ) ;
}

vec4 rgb2hsv(vec4 c)
{
    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

    float d = q.x - min(q.w, q.y);
    float e = 1.0e-10;
    return vec4(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x, c.a);
}

void fragment() {
	vec4 base = rgb2hsv(hue_color);
	base = vec4(base.r, 1.0, 1.0, base.a);
	
	vec4 col = mix(vec4(1.0), hsv2rgb(base), UV.x);
	col = mix(col, vec4(vec3(0.0), 1.0), UV.y);
	
	COLOR = col;
} "

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )
shader_param/hue_color = Color( 1, 0, 0, 1 )

[sub_resource type="Gradient" id=4]
offsets = PoolRealArray( 0, 0.167, 0.333, 0.5, 0.667, 0.833, 1 )
colors = PoolColorArray( 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1 )

[sub_resource type="GradientTexture" id=9]
gradient = SubResource( 4 )
width = 20

[sub_resource type="StyleBoxTexture" id=6]
texture = SubResource( 9 )
region_rect = Rect2( 0, 0, 20, 8 )

[sub_resource type="StyleBoxEmpty" id=8]

[sub_resource type="StyleBoxEmpty" id=7]

[sub_resource type="Gradient" id=10]
colors = PoolColorArray( 1, 1, 1, 1, 1, 0, 0, 1 )

[sub_resource type="GradientTexture" id=11]
gradient = SubResource( 10 )
width = 20

[sub_resource type="StyleBoxTexture" id=12]
texture = SubResource( 11 )
region_rect = Rect2( 0, 0, 20, 8 )

[sub_resource type="Gradient" id=13]
colors = PoolColorArray( 0, 0, 0, 1, 1, 0, 0, 1 )

[sub_resource type="GradientTexture" id=14]
gradient = SubResource( 13 )
width = 20

[sub_resource type="StyleBoxTexture" id=15]
texture = SubResource( 14 )
region_rect = Rect2( 0, 0, 20, 8 )

[sub_resource type="Gradient" id=16]
colors = PoolColorArray( 1, 1, 1, 0, 0, 0, 0, 1 )

[sub_resource type="GradientTexture" id=17]
gradient = SubResource( 16 )
width = 20

[sub_resource type="StyleBoxTexture" id=18]
texture = SubResource( 17 )
region_rect = Rect2( 0, 0, 20, 8 )

[sub_resource type="StyleBoxEmpty" id=19]

[sub_resource type="StyleBoxEmpty" id=20]

[node name="ColorPickPlus" type="VBoxContainer"]
margin_right = 168.0
margin_bottom = 153.0
custom_constants/separation = 4
script = ExtResource( 3 )

[node name="ColorGraph" type="TextureRect" parent="."]
show_behind_parent = true
material = SubResource( 2 )
margin_right = 168.0
margin_bottom = 93.0
size_flags_horizontal = 3
size_flags_vertical = 3
texture = ExtResource( 1 )
expand = true

[node name="SliderHue" type="HSlider" parent="."]
margin_top = 97.0
margin_right = 168.0
margin_bottom = 105.0
mouse_filter = 1
size_flags_vertical = 1
custom_icons/grabber_disabled = ExtResource( 2 )
custom_icons/grabber_highlight = ExtResource( 2 )
custom_icons/grabber = ExtResource( 2 )
custom_styles/slider = SubResource( 6 )
custom_styles/grabber_area_highlight = SubResource( 8 )
custom_styles/grabber_area = SubResource( 7 )
max_value = 1.0
step = 0.001

[node name="SliderSaturation" type="HSlider" parent="."]
margin_top = 109.0
margin_right = 168.0
margin_bottom = 117.0
mouse_filter = 1
custom_icons/grabber_disabled = ExtResource( 2 )
custom_icons/grabber_highlight = ExtResource( 2 )
custom_icons/grabber = ExtResource( 2 )
custom_styles/slider = SubResource( 12 )
custom_styles/grabber_area_highlight = SubResource( 8 )
custom_styles/grabber_area = SubResource( 7 )
max_value = 1.0
step = 0.001

[node name="SliderValue" type="HSlider" parent="."]
margin_top = 121.0
margin_right = 168.0
margin_bottom = 129.0
mouse_filter = 1
custom_icons/grabber_disabled = ExtResource( 2 )
custom_icons/grabber_highlight = ExtResource( 2 )
custom_icons/grabber = ExtResource( 2 )
custom_styles/slider = SubResource( 15 )
custom_styles/grabber_area_highlight = SubResource( 8 )
custom_styles/grabber_area = SubResource( 7 )
max_value = 1.0
step = 0.001

[node name="SliderAlpha" type="HSlider" parent="."]
margin_top = 133.0
margin_right = 168.0
margin_bottom = 141.0
mouse_filter = 1
custom_icons/grabber_disabled = ExtResource( 2 )
custom_icons/grabber_highlight = ExtResource( 2 )
custom_icons/grabber = ExtResource( 2 )
custom_styles/slider = SubResource( 18 )
custom_styles/grabber_area_highlight = SubResource( 19 )
custom_styles/grabber_area = SubResource( 20 )
max_value = 1.0
step = 0.001
value = 1.0

[node name="Colors" type="HBoxContainer" parent="."]
margin_left = 58.0
margin_top = 145.0
margin_right = 110.0
margin_bottom = 153.0
size_flags_horizontal = 6

[node name="Left" type="ColorRect" parent="Colors"]
margin_right = 24.0
margin_bottom = 8.0
rect_min_size = Vector2( 24, 8 )
mouse_filter = 1

[node name="Popup" type="Popup" parent="Colors/Left"]
margin_right = 40.0
margin_bottom = 40.0

[node name="ColorPicker" type="ColorPicker" parent="Colors/Left/Popup"]
margin_left = 48.0
margin_top = 48.0
margin_right = 356.0
margin_bottom = 510.0

[node name="Right" type="ColorRect" parent="Colors"]
margin_left = 28.0
margin_right = 52.0
margin_bottom = 8.0
rect_min_size = Vector2( 24, 8 )
mouse_filter = 1

[node name="Popup" type="Popup" parent="Colors/Right"]
margin_left = -28.0
margin_right = 12.0
margin_bottom = 40.0

[node name="ColorPicker" type="ColorPicker" parent="Colors/Right/Popup"]
margin_left = 52.0
margin_top = 52.0
margin_right = 360.0
margin_bottom = 514.0

[connection signal="gui_input" from="." to="." method="_on_ColorPickPlus_gui_input"]
[connection signal="gui_input" from="ColorGraph" to="." method="_on_TextureRect_gui_input"]
[connection signal="gui_input" from="SliderHue" to="." method="_on_slider_gui_input" binds= [ "Hue" ]]
[connection signal="value_changed" from="SliderHue" to="." method="_on_SliderHue_value_changed"]
[connection signal="gui_input" from="SliderSaturation" to="." method="_on_slider_gui_input" binds= [ "Saturation" ]]
[connection signal="value_changed" from="SliderSaturation" to="." method="_on_SliderSaturation_value_changed"]
[connection signal="gui_input" from="SliderValue" to="." method="_on_slider_gui_input" binds= [ "Value" ]]
[connection signal="value_changed" from="SliderValue" to="." method="_on_SliderValue_value_changed"]
[connection signal="gui_input" from="SliderAlpha" to="." method="_on_slider_gui_input" binds= [ "Alpha" ]]
[connection signal="value_changed" from="SliderAlpha" to="." method="_on_SliderAlpha_value_changed"]
[connection signal="gui_input" from="Colors/Left" to="." method="_on_Left_gui_input"]
[connection signal="gui_input" from="Colors/Right" to="." method="_on_Right_gui_input"]
